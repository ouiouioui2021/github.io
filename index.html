
    <!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>管理システム</title>
<link rel="stylesheet" href="stylesheet1.css">
</head>

<body>
下は、VBAのマクロ名をシンプルで分かりやすいものに変更するための提案です。これらのマクロは、保存して閉じる際、NG結果データの抽出、アクセスファイルへのaddnew、およびAddnew成功時の処理完了チェックを行います。
保存して閉じるマクロ:
保存してファイルを閉じる際に実行されるマクロです。
NGデータ抽出マクロ:
NG結果データを抽出し、情報を配列に格納するマクロです。
アクセスファイルへのデータ追加マクロ:
NG結果データをアクセスファイルに追加するマクロです。
Addnew成功時の処理完了チェックマクロ:
Addnewが成功した場合に実行され、処理完了をチェックするマクロです。
	
	保存して閉じるときのマクロ
NG結果データを抽出して情報を配列に入れるマクロ

NG結果データをアクセスファイルにaddnewするマクロ

Addnew成功なら処理完了のチェックを入れる処理を実行するマクロ

日付
ブック名
シート名
管理項目名
規格上限
規格下限
管理上限
管理下限
測定値
担当者
行番号-登録済み処理をするため

配列の処理
' 配列を初期化
Dim arr() As String

' For文のループ処理で配列に要素を追加
For i = 0 To 4
    If isArrayEx(arr) = -1 Then
        ' 配列が初期化されていない場合は初期化
        ReDim Preserve arr(0)
    Else
        ' 配列が初期化されている場合は要素を追加
        ReDim Preserve arr(UBound(arr) + 1)
    End If
    arr(UBound(arr)) = i * 2
Next

' 結果
' arr(0) 0
' arr(1) 2
' arr(2) 4
' arr(3) 6
' arr(4) 8
Public Sub AddDataToTableWithTransaction(tableName As String, fieldNames As Variant, dataRecords As Variant, dbPath As String)
    Dim conn As Object
    Dim rs As Object
    Dim strSQL As String

    ' データベース接続文字列を設定
    Dim provider As String
    provider = "Microsoft.ACE.OLEDB.12.0"
    connstr = "Provider=" & provider & ";Data Source=" & dbPath
    Set conn = CreateObject("ADODB.Connection")
    conn.Open connstr

    ' トランザクションを開始
    conn.BeginTrans

    On Error GoTo RollbackTransaction

    ' レコードセットを作成
    Set rs = CreateObject("ADODB.Recordset")
    rs.Open tableName, conn, adOpenKeyset, adLockOptimistic

    Dim i As Long
    For i = LBound(dataRecords, 1) To UBound(dataRecords, 1)
        rs.AddNew
        Dim j As Long
        For j = LBound(fieldNames) To UBound(fieldNames)
            rs.Fields(fieldNames(j)).Value = dataRecords(i, j)
        Next j
        rs.Update
    Next i

    ' トランザクションをコミット
    conn.CommitTrans

    ' 接続を閉じる
    rs.Close
    conn.Close
    Exit Sub

RollbackTransaction:
    ' エラーが発生した場合、トランザクションをロールバック
    conn.RollbackTrans
    MsgBox "エラーが発生しました。トランザクションをロールバックしました。"

    ' エラーメッセージをテキストファイルとして保存
    Dim errorFileName As String
    errorFileName = "error_" & Format(Now, "yyyyMMdd_HHmmss") & ".txt"
    Open errorFileName For Output As #1
    Print #1, "エラーが発生しました。トランザクションをロールバックしました。"
    Print #1, "エラーのあったファイル名: " & ThisWorkbook.Name
    Close #1
End Sub

' 使用例
Dim dataRecords As Variant
dataRecords = Array(Array("John", "Doe", 30, "Engineer"), _
                    Array("Alice", "Smith", 25, "Designer"))
Dim fieldNames As Variant
fieldNames = Array("FirstName", "LastName", "Age", "Occupation")
Dim tableName As String
tableName = "YourTableName"
Dim dbPath As String
dbPath = "C:\path\to\your\database.accdb"

AddDataToTableWithTransaction tableName, fieldNames, dataRecords, dbPath

	
</body>
</html>
